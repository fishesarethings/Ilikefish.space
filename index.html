<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZV53VVVSK3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-ZV53VVVSK3');
  </script>

  <!-- AdSense -->
  <script async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9929753961924881"
    crossorigin="anonymous"></script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>I like fishes _</title>
  <link rel="icon" href="/assets/img/ilikefishes.ico">
  <link rel="manifest" href="/manifest.json">

  <!-- External CSS -->
  <link rel="stylesheet" href="https://unpkg.com/locomotive-scroll/dist/locomotive-scroll.css">
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css">

  <!-- Merged styles.css + your inline styles -->
  <style>
    /* styles.css */
    body {
      margin: 0;
      font-family: sans-serif;
      overflow-x: hidden;
    }
    nav {
      position: fixed;
      top: 0;
      width: 100%;
      background: rgba(255,255,255,0.85);
      z-index: 1000;
    }
    nav ul {
      display: flex;
      justify-content: center;
      list-style: none;
      padding: 1rem;
      margin: 0;
    }
    nav a {
      margin: 0 1rem;
      color: #555;
      text-decoration: none;
    }
    .typewriter {
      display: inline-block;
      border-right: .15em solid #555;
      padding-right: .05em;
      white-space: nowrap;
      animation: blink-cursor .75s step-end infinite;
    }
    @keyframes blink-cursor {
      0%, 50% { border-color: #555; }
      50.01%,100% { border-color: transparent; }
    }
    .hero {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background-size: cover;
      background-position: center;
    }
    .section-interactive {
      padding: 5rem 2rem;
      background-size: cover;
      background-position: center;
    }
    .cards-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      padding: 1rem;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
    }
    .cards-container::-webkit-scrollbar { display: none; }
    .game-card {
      flex: 0 0 300px;
      margin-right: 2rem;
      scroll-snap-align: start;
      position: relative;
      overflow: hidden;
      border-radius: 1rem;
      transition: transform .3s;
    }
    .game-card:hover {
      transform: scale(1.05);
    }
    .game-card img {
      width: 100%;
      display: block;
    }
    .card-info {
      padding: 1rem;
      background: rgba(0,0,0,0.5);
      color: #fff;
      position: absolute;
      bottom: 0;
      width: 100%;
    }
    .box {
      background: rgba(200,200,200,0.3);
      padding: 1rem;
      border-radius: .5rem;
      margin-bottom: 2rem;
    }
    .copy-box {
      display: flex;
      align-items: center;
      margin: 1rem 0;
    }
    .copy-box span {
      flex: 1;
    }
    .copy-box button,
    #enter-fullscreen {
      margin-left: 1rem;
      padding: .5rem 1rem;
    }
    #activityChart {
      max-width: 100%;
      height: 300px;
    }

    /* Progress bar */
    #download-progress {
      position: fixed; bottom: 3.5rem; left: 50%;
      transform: translateX(-50%);
      width: 220px; height: 6px;
      background: rgba(0,0,0,0.1);
      border-radius: 3px; overflow: hidden;
      display: none; z-index: 1001;
    }
    #download-progress .bar {
      height: 100%; width: 0%; background: #007aff;
      transition: width .2s ease;
    }
    #download-complete {
      position: fixed; bottom: 2rem; left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7); color: #fff;
      padding: .3rem .6rem; border-radius: 4px;
      font-size: .85rem; display: none; z-index: 1001;
    }
    .hero.first { background: #fff !important; }
  </style>

  <!-- Cache-bust -->
  <script>
    const PAGE_VER = '1.2.0';
    if (localStorage.getItem('siteVersion') !== PAGE_VER) {
      localStorage.clear();
      localStorage.setItem('siteVersion', PAGE_VER);
      location.reload(true);
    }
  </script>
</head>
<body data-scroll-container>
  <script>
    window.addEventListener('load', () => AOS.init({ duration:800, once:true }));
  </script>

  <!-- Cookie Consent -->
  <script src="https://static.elfsight.com/platform/platform.js" async></script>
  <div class="elfsight-app-759580a9-e1f2-4577-a688-728cfd2bc50a" data-elfsight-app-lazy></div>

  <!-- Navigation -->
  <nav data-aos="fade-down">
    <ul>
      <li><a href="/index.html">Home</a></li>
      <li><a href="/games.html">Games</a></li>
      <li><a href="/server.html">Server</a></li>
    </ul>
  </nav>

  <!-- Hero -->
  <section class="hero first" data-scroll-section data-aos="fade-up"
           style="background-image:url('/assets/img/bg-home.jpg');">
    <h1 id="hero-title" class="typewriter">I like fishes _</h1>
  </section>

  <!-- Featured & All Games -->
  <section class="section-interactive" data-scroll-section style="background-image:url('/assets/img/bg-games.jpg');">
    <h2 data-scroll data-scroll-speed="2">Featured Games</h2>
    <div id="featured-games" class="cards-container"></div>
  </section>
  <section class="section-interactive" data-scroll-section style="background-image:url('/assets/img/bg-games.jpg');">
    <h2 data-scroll data-scroll-speed="1">All Games</h2>
    <div id="all-games" class="cards-container"></div>
  </section>

  <!-- Inlined games-list.js -->
  <script>
    window.addEventListener('DOMContentLoaded', async () => {
      console.log('[games-list] DOM ready, fetching /games/index.json…');
      let index;
      try {
        index = await fetch('/games/index.json').then(r => {
          if (!r.ok) throw new Error(`HTTP ${r.status}`);
          return r.json();
        });
      } catch (err) {
        return console.error('[games-list] ❌ failed to load /games/index.json:', err);
      }
      for (const slug of index.folders) {
        try {
          const resp = await fetch(`/games/${slug}/config.json`);
          if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
          const game = await resp.json();
          renderGameCard(game);
        } catch (e) {
          console.error(`[games-list] ❌ failed for "${slug}":`, e);
        }
      }
    });
    function renderGameCard(game) {
      if (!game.folder||!game.icon||!game.entry||!game.name) return;
      const card = document.createElement('div');
      card.className = 'game-card';
      card.innerHTML = `
        <img src="/games/${game.folder}/${game.icon}" alt="${game.name}">
        <div class="card-info">
          <h3>${game.name}</h3>
          <button onclick="window.open('/games/${game.folder}/${game.entry}','_blank')">Play</button>
        </div>`;
      const feat = document.getElementById('featured-games');
      if (feat.children.length < 3) feat.append(card.cloneNode(true));
      document.getElementById('all-games').append(card.cloneNode(true));
      document.getElementById('games-container')?.append(card);
    }
  </script>

  <!-- Progress indicators -->
  <div id="download-progress"><div class="bar"></div></div>
  <div id="download-complete">Download complete!</div>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.ready.then(() => {
        const p = document.getElementById('download-progress');
        const b = p.querySelector('.bar');
        const d = document.getElementById('download-complete');
        navigator.serviceWorker.addEventListener('message', ev => {
          if (ev.data?.type==='PRECACHE_PROGRESS') {
            p.style.display='block';
            b.style.width=ev.data.percent+'%';
            if (ev.data.percent>=100) {
              p.style.display='none';
              d.style.display='block';
              setTimeout(()=>d.style.display='none',2000);
            }
          }
        });
      });
    }
  </script>

  <!-- Server teaser -->
  <section class="section-interactive" data-scroll-section data-aos="fade-up"
           style="background-image:url('/assets/img/bg-server.jpg');">
    <h2 data-scroll data-scroll-speed="2">Our Minecraft Server</h2>
    <div class="box">
      <label>Join Address</label>
      <div class="copy-box">
        <span id="address">ilikefish.space</span>
        <button onclick="copyText('ilikefish.space')">Copy</button>
      </div>
      <label>Port</label>
      <div class="copy-box">
        <span id="port">19132</span>
        <button onclick="copyText('19132')">Copy</button>
      </div>
      <button id="enter-fullscreen">Full Screen Stats</button>
    </div>
    <canvas id="activityChart"></canvas>
  </section>

  <!-- Inlined server.js -->
  <script>
    console.log('[server] script loaded');
    window.copyText = txt =>
      navigator.clipboard.writeText(txt)
        .then(()=>console.log('[server] copied:',txt))
        .catch(err=>console.error('[server] copy failed:',err));
    window.addEventListener('DOMContentLoaded', async () => {
      const addressEl = document.getElementById('address');
      const portEl = document.getElementById('port');
      if (!addressEl||!portEl) return;
      addressEl.textContent='ilikefish.space';
      portEl.textContent='19132';
      const ctx = document.getElementById('activityChart');
      if (!ctx) return;
      try {
        const res = await fetch('https://api.mcsrvstat.us/bedrock/2/ilikefish.space:19132');
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        new Chart(ctx, {
          type: 'line',
          data: { labels:['Now'], datasets:[{label:'Players Online',data:[data.players?.online||0]}] },
          options:{responsive:true}
        });
      } catch {
        ctx.parentNode.innerHTML='<p>Server stats unavailable</p>';
      }
    });
  </script>

  <!-- Inlined typing.js -->
  <script>
    window.addEventListener('load', () => {
      const TEXT = 'I like fishes ';
      const el = document.getElementById('hero-title');
      let idx = 0;
      el.textContent = '';
      (function typeChar(){
        if(idx<TEXT.length){
          el.textContent+=TEXT.charAt(idx++);
          setTimeout(typeChar,150);
        }
      })();
    });
  </script>

  <!-- Inlined loco.js -->
  <script>
    window.addEventListener('load', () => {
      new LocomotiveScroll({
        el: document.querySelector('[data-scroll-container]'),
        smooth: true,
        multiplier: 1.2
      });
    });
  </script>

  <!-- Inlined sw-register.js -->
  <script>
    if('serviceWorker' in navigator){
      window.addEventListener('load',()=>{
        navigator.serviceWorker.register('/service-worker.js')
          .then(reg=>console.log('SW registered:',reg.scope))
          .catch(err=>console.error('SW registration failed:',err));
      });
    }
  </script>

  <!-- Inlined fullscreen.js -->
  <script>
    document.getElementById('enter-fullscreen')
      .addEventListener('click', () => {
        const elem = document.getElementById('activityChart').parentNode;
        (elem.requestFullscreen||elem.webkitRequestFullscreen).call(elem);
      });
  </script>

  <!-- Footer -->
  <footer style="text-align:center;padding:1rem;color:#666;font-size:.8rem;">
    <p>Site Version: 1.2.0</p>
    <p>
      Dedicated to the public domain under the
      <a href="https://unlicense.org/" target="_blank" rel="noopener">Unlicense</a>.<br>
      © 2025 fishesarethings — No rights reserved.
    </p>
  </footer>
</body>
</html>
